{"version":3,"sources":["components/Layout.js","components/Homepage.js","components/Schema.js","index.js"],"names":["module","exports","vnode","bundle","attrs","redraw","m","href","arr","oncreate","route","link","class","get","style","allmodels","Object","keys","models","filter","mk","model","path","length","map","name","omodels","push","concat","isLocal","meta","version","children","currentId","schema","schemaCache","exampleCache","example","id","title","p","out","description","properties","pk","po","type","JSON","stringify","Layout","require","Homepage","Schema","root","document","getElementById","window","location","hostname","bundleUrl","loadedBundle","loadingBundle","request","background","then","data","log","render"],"mappings":"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","file":"src.1ef3662f.map","sourceRoot":"../src","sourcesContent":["\nmodule.exports = {\n  oninit: (vnode) => {\n    this.bundle = vnode.attrs.bundle()\n  },\n  onupdate: (vnode) => {\n    if (this.bundle !== vnode.attrs.bundle()) {\n      this.bundle = vnode.attrs.bundle()\n      m.redraw()\n    }\n  },\n  view: (vnode) => {\n    return m('div', [\n      m('div', { 'style': 'padding-bottom: 5em;' },  [\n        m('nav#navbar.navbar', [\n          m('.container', [\n            m('.navbar-brand', [\n              m('a.navbar-item', { href: 'https://data.opencrypto.io/' }, [\n                m('#logo'),\n                m('#logo-text', [\n                  m('span.thin', 'Open'),\n                  'Crypto',\n                  m('span.green', 'Data'),\n                ])\n              ])\n            ]),\n            m('.navbar-menu', [\n              m('.navbar-start', [\n                m('a.navbar-item', { href: 'https://data.opencrypto.io' }, 'Homepage'), \n                m('a.navbar-item', { href: 'https://explorer.opencrypto.io' }, 'Explorer'), \n                m('a.navbar-item.current', { href: 'https://schema.opencrypto.io' }, 'Schema'), \n              ]),\n              m('.navbar-end', [\n                m('a.navbar-item', { href: '#' }, 'How to contribute?'), \n                m('a.navbar-item', { href: '#' }, 'FAQ'), \n              ])\n            ])\n          ])\n        ]),\n        m('nav#subbar.navbar', [\n          m('.container', [\n            m('.navbar-menu', [\n              m('.navbar-start', (() => {\n                let arr = [\n                  m('a.navbar-item', { href: '/', oncreate: m.route.link, class: m.route.get() === '/' ? 'selected' : null }, 'Introduction'),\n                  m('span.navbar-item', { style: 'font-size: 8px; color: silver;'  }, ' ● ')\n                ]\n                if (!this.bundle) {\n                  return arr\n                }\n                let allmodels = Object.keys(this.bundle.models)\n                let models = allmodels.filter((mk) => {\n                  let model = this.bundle.models[mk]\n                  return model.path.length < 3\n                }).map(mk => {\n                  let model = this.bundle.models[mk]\n                  let href = `/model/${mk}`\n                  return m('a.navbar-item', { href, oncreate: m.route.link, class: m.route.get() === href ? 'selected' : null }, model.name)\n                })\n                //console.log(models)\n                let omodels = allmodels.filter(mk => {\n                  let model = this.bundle.models[mk]\n                  return model.path.length >= 3\n                })\n                if (omodels.length > 0) {\n                  models.push(m('.navbar-item.has-dropdown.is-hoverable', [\n                    m('a.navbar-link', 'Other'),\n                    m('.navbar-dropdown', omodels.map(mk => {\n                      let model = this.bundle.models[mk]\n                      let href = `/model/${mk}`\n                      return m('a.navbar-item', { href, oncreate: m.route.link, class: m.route.get() === href ? 'selected' : null }, model.name)\n                    }))\n                  ]))\n                }\n                return arr.concat(models)\n              })()),\n              m('.navbar-end', (() => {\n                if (!this.bundle) {\n                  return null\n                }\n                return m('.navbar-item', [\n                  m('div.select.is-rounded', [\n                    m('select', [\n                      m('option', this.bundle.isLocal ? `v${this.bundle.meta.version} (local)` : `v${this.bundle.meta.version} (latest)`)\n                    ])\n                  ])\n                ])\n              })())\n            ])\n          ])\n        ]),\n        m('.container', function() {\n          if (true) {\n            return m('#page', vnode.children)\n          }\n          return m('div', { style: 'padding: 2em;' }, 'Loading ..')\n        }())\n      ])\n    ])\n  }\n}\n","module.exports = {\n  view: () => {\n    return m('div', 'Homepage')\n  }\n}\n","var currentId = null\nvar schema = null\nvar schemaCache = {}\nvar exampleCache = {}\nvar example = null\n\nmodule.exports = {\n  oninit: (vnode) => {\n    this.bundle = vnode.attrs.bundle()\n    if (this.bundle) {\n      this.model = this.bundle.models[vnode.attrs.id]\n    }\n  },\n  onupdate: (vnode) => {\n    if (this.bundle !== vnode.attrs.bundle()) {\n      this.bundle = vnode.attrs.bundle()\n      this.model = this.bundle.models[vnode.attrs.id]\n      m.redraw()\n    } else if (this.model && this.model.id !== vnode.attrs.id) {\n      this.model = this.bundle.models[vnode.attrs.id]\n      m.redraw()\n    }\n  },\n  view: (vnode) => {\n    if (!this.model) {\n      return m('div', 'Loading ...')\n    }\n    const schema = this.model.schema\n    return m('div', [\n      m('h2.my-title', schema.title),\n      m('.path', this.model.path.map(p => {\n        var out = [ m('a', { href: `/model/${p}`, oncreate: m.route.link }, this.bundle.models[p].name) ]\n        if (p !== this.model.id) {\n          out.push(m('b', { style: 'padding: 0 0.4em;' }, ' → '))\n        }\n        return out\n      })),\n      m('.description', schema.description), \n      m('.props', Object.keys(schema.properties).map(pk => {\n        let po = schema.properties[pk]\n        return m('.custom-box', [\n          m('div', [\n            m('b', pk),\n            m('span', '   '),\n            m('i', { style: 'padding-left: 0.5em; color: #999999;' }, '{' +po.type + '}')\n          ]),\n          po.title ? m('div', { style: 'color: #999999;' }, po.title + (po.description ? ' - ' + po.description : '')) : null,\n          this.model.example[pk] ? m('pre.example', JSON.stringify(this.model.example[pk], null, 2)) : null,\n        ])\n      }))\n    ])\n  }\n}\n","const Layout = require('./components/Layout')\n\nconst Homepage = require('./components/Homepage')\nconst Schema = require('./components/Schema')\n\nconst root = document.getElementById('schema-explorer')\n\nconst isLocal = window.location.hostname === 'localhost'\nconst bundleUrl = isLocal ?\n  '/schema/build/bundle.json' : 'https://schema.opencrypto.io/build/bundle.json'\n\nvar loadedBundle = null\nvar loadingBundle = null\n\nfunction bundle() {\n  if (!loadedBundle && !loadingBundle) {\n    loadingBundle = true\n    m.request(bundleUrl, { background: true }).then(data => {\n      loadedBundle = data\n      loadedBundle.isLocal = isLocal\n      loadingBundle = false\n      console.log('Loaded from: %s', bundleUrl)\n      m.redraw()\n    })\n  }\n  return loadedBundle\n}\n\nm.route(root, '/', {\n  '/': { render: (vnode) => m(Layout, { bundle }, m(Homepage, { bundle })) },\n  '/model/:id': { render: (vnode) => m(Layout, { bundle }, m(Schema, { bundle, id: vnode.attrs.id })) }\n})\n"]}